<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="main-container">
    <aside class="sidebar">
        <div class="sidebar-header">
            <span style="color: #66ccff; font-weight: bold;">ManageEasy</span>
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li><a href="#" class="active"><i class="fa fa-tachometer-alt"></i> Dashboard</a></li>
                <li class="has-submenu">
                    <a href="#" onclick="toggleSubmenu(event)">
                        <i class="fa fa-users"></i> User Management
                        <i class="fa fa-chevron-down" style="margin-left: auto; font-size: 0.8em;"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="/users"><i class="fa fa-user-circle"></i> Manage Users</a></li>
                        <li><a href="/users/groups"><i class="fa fa-users-cog"></i> Manage Groups</a></li>
                    </ul>
                </li>
                <li><a href="#"><i class="fa fa-tags"></i> Categories</a></li>
                <li class="has-submenu">
                    <a href="#" onclick="toggleSubmenu(event)">
                        <i class="fa fa-box"></i> Products
                        <i class="fa fa-chevron-down" style="margin-left: auto; font-size: 0.8em;"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="/products"><i class="fa fa-boxes"></i> Manage Products</a></li>
                        <li><a href="/products/add"><i class="fa fa-plus-circle"></i> Add Product</a></li>
                    </ul>
                </li>
                <li><a href="#"><i class="fa fa-images"></i> Media Files</a></li>
                <li class="has-submenu">
                    <a href="#" onclick="toggleSubmenu(event)">
                        <i class="fa fa-chart-line"></i> Sales
                        <i class="fa fa-chevron-down" style="margin-left: auto; font-size: 0.8em;"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="/sales"><i class="fa fa-list"></i> Manage Sales</a></li>
                        <li><a href="/sales/add"><i class="fa fa-plus-circle"></i> Add Sale</a></li>
                    </ul>
                </li>
                <li class="has-submenu">
                    <a href="#" onclick="toggleSubmenu(event)">
                        <i class="fa fa-file-invoice"></i> Sales Report
                        <i class="fa fa-chevron-down" style="margin-left: auto; font-size: 0.8em;"></i>
                    </a>
                    <ul class="submenu">
                        <li><a href="/reports/daily"><i class="fa fa-calendar-day"></i> Daily Sales</a></li>
                        <li><a href="/reports/monthly"><i class="fa fa-calendar-alt"></i> Sales by Month</a></li>
                        <li><a href="/reports/date"><i class="fa fa-calendar"></i> Sales by Date</a></li>
                    </ul>
                </li>
                <li class="logout"><a href="/logout"><i class="fa fa-sign-out-alt"></i> Logout</a></li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <% if (typeof currentUser !== 'undefined') { %>
                <div class="user-profile">
                    <a href="/profile" title="Edit Profile">
                        <% if (currentUser.avatar) { %>
                            <img src="<%= currentUser.avatar %>" alt="avatar" class="profile-img" />
                        <% } else { %>
                            <span class="profile-circle"><%= currentUser.email.charAt(0).toUpperCase() %></span>
                        <% } %>
                    </a>
                    <span class="user-name"><%= currentUser.name || currentUser.email %></span>
                </div>
            <% } %>
        </div>
        
    </aside>

    <main class="dashboard-content">
        <header class="dashboard-header">
            <h1 class="page-title">Admin Dashboard</h1>
        </header>

        <div class="card welcome-card">
            <div class="card-body">
                Welcome to Inventory Management System
            </div>
        </div>

        <div class="metric-cards">
            <div class="metric-card users">
                <div class="icon"><i class="fa fa-users"></i></div>
                <div class="info"><h3>5</h3><p>Users</p></div>
            </div>
            <div class="metric-card categories">
                <div class="icon"><i class="fa fa-tags"></i></div>
                <div class="info"><h3>8</h3><p>Categories</p></div>
            </div>
            <div class="metric-card products">
                <div class="icon"><i class="fa fa-box"></i></div>
                <div class="info"><h3>16</h3><p>Products</p></div>
            </div>
            <div class="metric-card sales">
                <div class="icon"><i class="fa fa-dollar-sign"></i></div>
                <div class="info"><h3>7513.00</h3><p>Sales</p></div>
            </div>
        </div>

        <div class="content-grid">
            <div class="card">
                <div class="card-header">Highest Selling Products</div>
                <div class="card-body">
                    <table>
                        <thead><tr><th>Product Name</th><th>Total Sold</th><th>Total Quantity</th></tr></thead>
                        <tbody>
                            <tr><td>Organic Milk (1L)</td><td>125</td><td>500</td></tr>
                            <tr><td>Whole Wheat Bread</td><td>98</td><td>350</td></tr>
                            <tr><td>Fresh Tomatoes</td><td>85</td><td>220</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <div class="card-header">Latest Sales</div>
                <div class="card-body">
                    <table>
                        <thead><tr><th>#</th><th>Product Name</th><th>Date</th><th>Total Sale</th></tr></thead>
                        <tbody>
                            <tr><td>1</td><td>Organic Eggs (dozen)</td><td>2023-10-26</td><td>$45.00</td></tr>
                            <tr><td>2</td><td>Avocados (each)</td><td>2023-10-26</td><td>$12.00</td></tr>
                            <tr><td>3</td><td>Greek Yogurt</td><td>2023-10-25</td><td>$28.50</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="card">
                <div class="card-header">Recently Added Products</div>
                <div class="card-body">
                    <table>
                        <thead><tr><th>Product Name</th><th>Category</th><th>Price</th></tr></thead>
                        <tbody>
                            <tr><td>Mangoes</td><td>Fruits</td><td>$2.50</td></tr>
                            <tr><td>Brown Sugar</td><td>Baking</td><td>$4.75</td></tr>
                            <tr><td>Lentils (1kg)</td><td>Pantry</td><td>$3.99</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>
</div>

<style>
    body {
        font-family: 'Open Sans', sans-serif;
        color: #212529;
        background-color: #f8f9fa;
        margin: 0;
        display: flex;
        min-height: 100vh;
    }

    .main-container {
        display: flex;
        width: 100%;
    }

    .sidebar {
        width: 250px;
        background-color: #34495e;
        color: #ffffff;
        padding: 20px;
        box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .sidebar-header {
        font-size: 2em;
        font-weight: bold;
        padding-bottom: 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 20px;
    }

    .sidebar-nav ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .sidebar-nav li {
        margin-bottom: 15px;
    }

    .sidebar-nav a {
        color: #ffffff;
        text-decoration: none;
        font-size: 1.2em;
        display: block;
        padding: 10px;
        border-radius: 5px;
        transition: background-color 0.3s, color 0.3s;
    }

    .sidebar-nav a:hover {
        background-color: #2c3e50;
    }

    .sidebar-nav i {
        margin-right: 10px;
        font-size: 1.2em;
    }

    .sidebar-nav .logout a {
        color: #000000;
        background-color: #f8f9fa;
        font-weight: bold;
    }

    .sidebar-nav .logout a:hover {
        background-color: #e2e6ea;
    }

    .dashboard-content {
        flex-grow: 1;
        padding: 20px;
    }
    
    .dashboard-header {
        margin-bottom: 20px;
    }

    .page-title {
        color: #212529;
        text-align: left;
        margin: 0;
    }

    .card {
        background-color: #ffffff;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        margin-bottom: 20px;
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
    }

    .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 15px rgba(0,0,0,0.12);
    }

    .card-header {
        background-color: #f8f9fa;
        padding: 18px 20px;
        border-bottom: 1px solid #e0e6ed;
        font-weight: 600;
        color: #495057;
        font-size: 1.1em;
    }

    .card-body {
        padding: 20px;
    }
    
    table {
        width: 100%;
        border-collapse: collapse;
    }

    th, td {
        padding: 12px 15px;
        text-align: left;
        border-bottom: 1px solid #e9ecef;
        color: #495057;
    }

    thead th {
        background-color: #f2f4f6;
        color: #343a40;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.9em;
    }

    tr:nth-child(even) {
        background-color: #fdfdfd;
    }

    .welcome-card {
        background-color: #d4edda;
        border-color: #c3e6cb;
        color: #155724;
        font-weight: bold;
        text-align: center;
    }

    .metric-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .metric-card {
        display: flex;
        align-items: center;
        background: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        cursor: pointer;
    }
    
    .metric-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
    }
    
    .metric-card .icon {
        font-size: 36px;
        margin-right: 20px;
        padding: 18px;
        border-radius: 50%;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: background-color 0.2s ease-in-out;
    }
    
    .metric-card:hover .icon {
        background-color: #007bff !important;
    }
    
    .metric-card .info h3 {
        margin: 0;
        font-size: 26px;
        color: #212529;
        font-weight: 700;
    }
    
    .metric-card .info p {
        margin: 0;
        color: #6c757d;
        font-size: 0.9em;
    }
    
    .metric-card.users .icon { background-color: #6c757d; }
    .metric-card.categories .icon { background-color: #fd7e14; }
    .metric-card.products .icon { background-color: #007bff; }
    .metric-card.sales .icon { background-color: #28a745; }
    
    .content-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
    }
    
    @media (max-width: 992px) {
        .main-container {
            flex-direction: column;
        }
        .sidebar {
            width: 100%;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .sidebar-nav ul {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
        }
        .sidebar-nav li {
            margin: 5px;
        }
        .sidebar-nav a {
            padding: 8px 12px;
            font-size: 1em;
        }
        .sidebar-nav i {
            display: none;
        }
        .dashboard-content {
            padding: 10px;
        }
    }

    @media (max-width: 768px) {
        .metric-cards {
            grid-template-columns: 1fr;
        }
        .content-grid {
            grid-template-columns: 1fr;
        }
    }
    
    /* New CSS for the profile footer */
    .sidebar-footer {
        padding-top: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
        text-align: center;
    }

    .user-profile {
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ffffff;
        font-size: 1.1em;
        font-weight: 600;
    }

    .profile-circle {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #66ccff;
        color: #34495e;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        font-size: 1.5em;
        margin-right: 10px;
    }

    .profile-img {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 10px;
        border: 2px solid #66ccff;
    }

    /* Updated submenu styles */
    .submenu {
        list-style: none;
        padding-left: 34px;
        margin: 0;
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease-out;
    }

    .submenu a {
        padding: 8px 12px !important;
        font-size: 0.95em !important;
        color: rgba(255,255,255,0.85) !important;
        display: flex !important;
        align-items: center;
    }

    .submenu a i {
        font-size: 0.9em;
        width: 20px;
        margin-right: 8px;
    }

    .has-submenu > a {
        display: flex !important;
        align-items: center;
    }

    .has-submenu.open > a {
        background: rgba(255,255,255,0.05);
    }

    .has-submenu.open .submenu {
        max-height: 500px;
        margin-top: 5px;
        margin-bottom: 10px;
    }

    .has-submenu .fa-chevron-down {
        transition: transform 0.3s ease;
    }

    .has-submenu.open .fa-chevron-down {
        transform: rotate(180deg);
    }

    /* Action buttons */
    .action-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
    }

    .btn-action {
        padding: 8px 16px;
        border-radius: 6px;
        background: var(--primary);
        color: white;
        border: none;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        text-decoration: none;
        font-weight: 600;
    }

    .btn-action.secondary {
        background: #6c757d;
    }

    .btn-action i {
        font-size: 0.9em;
    }

    /* Profile dropdown styles */
    .topbar-right {
        display: flex;
        justify-content: flex-end;
        align-items: center;
        margin-left: auto;
    }

    .profile-wrap {
        position: relative;
    }

    .avatar-btn {
        background: transparent;
        border: none;
        cursor: pointer;
        outline: none;
        display: flex;
        align-items: center;
    }

    .profile-img {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        object-fit: cover;
        margin-right: 10px;
    }

    .profile-menu {
        position: absolute;
        top: 100%;
        right: 0;
        background: #ffffff;
        border: 1px solid #e9ecef;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        z-index: 1000;
        width: 200px;
        display: none;
        flex-direction: column;
    }

    .profile-menu.open {
        display: flex;
    }

    .profile-info {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid #e9ecef;
    }

    .profile-info strong {
        display: block;
        color: #212529;
        font-size: 1em;
    }

    .profile-info .muted {
        color: #868e96;
        font-size: 0.85em;
    }

    .profile-menu ul {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .profile-menu li {
        border-bottom: 1px solid #e9ecef;
    }

    .profile-menu a {
        padding: 12px 15px;
        color: #212529;
        text-decoration: none;
        display: block;
        transition: background-color 0.3s;
    }

    .profile-menu a:hover {
        background-color: #f8f9fa;
    }
</style>

<script>
function toggleSubmenu(e) {
    e.preventDefault();
    const parent = e.currentTarget.parentElement;
    parent.classList.toggle('open');
    const submenu = parent.querySelector('.submenu');
    if (parent.classList.contains('open')) {
        submenu.style.maxHeight = submenu.scrollHeight + "px";
    } else {
        submenu.style.maxHeight = 0;
    }
}

// Profile dropdown toggle
(function () {
    const btn = document.getElementById('avatarBtn');
    const menu = document.getElementById('profileMenu');
    const wrap = document.getElementById('profileWrap');
    if (!btn || !menu) return;
    btn.addEventListener('click', function (e) {
        e.stopPropagation();
        const open = menu.getAttribute('aria-hidden') === 'false';
        menu.setAttribute('aria-hidden', String(!open));
        btn.setAttribute('aria-expanded', String(!open));
        menu.classList.toggle('open', !open);
    });
    document.addEventListener('click', function (e) {
        if (!wrap.contains(e.target)) {
            menu.setAttribute('aria-hidden', 'true');
            menu.classList.remove('open');
            btn.setAttribute('aria-expanded', 'false');
        }
    });
})();
</script>

</body>
</html>